<mvc:View controllerName="project1.controller.Main"
    xmlns:mvc="sap.ui.core.mvc"
	xmlns:core="sap.ui.core"
    xmlns="sap.m">
    <Page id="page" title="{i18n>booksListTitle}">
        <Table
            id="booksList"
            width="auto"
            mode="MultiSelect"
            items="{
                path: 'booksModel>/currentBooks'
            }">
            <headerToolbar>
                <Toolbar>
                    <Button 
                        text="{i18n>buttonAddRecord}"
						press="onAddRecord">
                        <layoutData>
                            <FlexItemData growFactor="1" />
                        </layoutData>
                    </Button>
                    <ToolbarSpacer/>
                    <Button
                        text="{i18n>buttonDeleteRecord}"
                        press=".onOpenDialog">
                        <layoutData>
                            <FlexItemData growFactor="1" />
                        </layoutData>
                    </Button>
                    <Input
                        width="50%"
                        valueLiveUpdate="true"
                        liveChange=".onSetSearchedName"/>
                    <ToolbarSpacer/>
                    <ComboBox
                        selectedKey="0"
                        selectionChange=".onSetSelectedGenre"
                        items="{
                            path: 'booksModel>/genres'
                        }">
                        <core:Item key="{booksModel>key}" text="{booksModel>title}" />
                    </ComboBox>
                    <ToolbarSpacer/>
                    <Button text="{i18n>buttonFilter}" press="onFilterTable" />
                </Toolbar>
            </headerToolbar>
            <columns>
                <Column>
                    <Text text="{i18n>columnName}" />
                </Column>
                <Column
                    minScreenWidth="Small"
                    demandPopin="true">
                    <Text text="{i18n>columnAuthor}" />
                </Column>
                <Column
                    minScreenWidth="Small"
                    demandPopin="true">
                    <Text text="{i18n>columnGenre}" />
                </Column>
                <Column
                    minScreenWidth="Small"
                    demandPopin="true">
                    <Text text="{i18n>columnReleaseDate}" />
                </Column>
                <Column
                    minScreenWidth="Small"
                    demandPopin="true">
                    <Text text="{i18n>columnAvailableQuantity}" />
                </Column>
                <Column
                    hAlign="End"
                    width="10em"
                    minScreenWidth="Small"
                    demandPopin="true">
                    <Text text="{i18n>columnActions}" />
                </Column>
            </columns>
            <items>
                <ColumnListItem>
                    <cells>
                        <FlexBox>
                            <ObjectIdentifier 
                                visible="{= !${booksModel>isEditable}}" 
                                title="{booksModel>Name}"
                                />
                            <Input
                                visible="{booksModel>isEditable}"
                                value="{booksModel>Name}"
                                />
                        </FlexBox>
                        <Text text="{booksModel>Author}" />
                        <Text text="{booksModel>Genre/title}" />
                        <Text
                            core:require="{
                                Formatter: 'project1/model/formatter'
                            }"
                            text="{
                                    parts: [
                                        'booksModel>ReleaseDate'
                                    ],
                                    formatter: 'Formatter.rormatDate.bind($controller)'
                            }"/>
                        <ObjectNumber
                            number="{booksModel>AvailableQuantity}"
                            emphasized="false"/>
                        <FlexBox justifyContent="{= !${booksModel>isEditable} ? 'End' : 'SpaceBetween'}">
                            <Button 
                                text="{i18n>buttonEdit}"
                                visible="{= !${booksModel>isEditable}}"
                                press="onEditTitle"/>
                            <Button 
                                text="{i18n>buttonSave}"
                                visible="{booksModel>isEditable}"
                                press="onSaveTitle"/>
                            <Button 
                                text="{i18n>buttonCancel}"
                                visible="{booksModel>isEditable}"
                                press="onCancelUpdateTitle"/>
                        </FlexBox>
                    </cells>
                </ColumnListItem>
            </items>
        </Table>
    </Page>
</mvc:View>