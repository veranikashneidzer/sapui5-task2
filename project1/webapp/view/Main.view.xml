<mvc:View controllerName="project1.controller.Main"
    xmlns:mvc="sap.ui.core.mvc"
	xmlns:core="sap.ui.core"
    xmlns="sap.m">
    <Page id="page" title="{i18n>booksListTitle}">
        <Table
            id="booksList"
            width="auto"
            mode="MultiSelect"
            items="{
                path: 'books>/books'
            }">
            <headerToolbar>
                <Toolbar>
                    <Button 
                        text="{i18n>buttonAddRecord}"
						press="onAddRecord">
                        <layoutData>
                            <FlexItemData growFactor="1" />
                        </layoutData>
                    </Button>
                    <ToolbarSpacer/>
                    <Button
                        text="{i18n>buttonDeleteRecord}"
                        press="onDeleteRecord">
                        <layoutData>
                            <FlexItemData growFactor="1" />
                        </layoutData>
                    </Button>
                    <Input
                        width="50%"
                        valueLiveUpdate="true"
                        liveChange=".onSetSearchedName"/>
                    <ToolbarSpacer/>
                    <ComboBox
                        selectedKey="0"
                        selectionChange=".onSetSelectedGenre"
                        items="{
                            path: 'books>/genres'
                        }">
                        <core:Item key="{books>key}" text="{books>title}" />
                    </ComboBox>
                    <ToolbarSpacer/>
                    <Button text="{i18n>buttonFilter}" press="onFilterTable" />
                </Toolbar>
            </headerToolbar>
            <columns>
                <Column>
                    <Text text="{i18n>columnName}" />
                </Column>
                <Column
                    minScreenWidth="Small"
                    demandPopin="true">
                    <Text text="{i18n>columnAuthor}" />
                </Column>
                <Column
                    minScreenWidth="Small"
                    demandPopin="true">
                    <Text text="{i18n>columnGenre}" />
                </Column>
                <Column
                    minScreenWidth="Small"
                    demandPopin="true">
                    <Text text="{i18n>columnReleaseDate}" />
                </Column>
                <Column
                    minScreenWidth="Small"
                    demandPopin="true">
                    <Text text="{i18n>columnAvailableQuantity}" />
                </Column>
                <Column
                    hAlign="End"
                    width="5em"
                    minScreenWidth="Small"
                    demandPopin="true">
                    <Text text="{i18n>columnActions}" />
                </Column>
            </columns>
            <items>
                <ColumnListItem>
                    <cells>
                        <FlexBox>
                            <ObjectIdentifier 
                                visible="{= !${books>isEditable}}" 
                                title="{books>currentName}"
                                />
                            <Input
                                visible="{books>isEditable}"
                                value="{books>currentName}"
                                liveChange=".onChangeBookName"
                                />
                            <Button 
                                text="{i18n>buttonCancel}"
                                visible="{books>isEditable}"
                                press="onCancelUpdateTitle"/>
                        </FlexBox>
                        <Text text="{books>Author}" />
                        <Text text="{books>Genre/title}" />
                        <Text
                            core:require="{
                                Formatter: 'project1/model/formatter'
                            }"
                            text="{
                                    parts: [
                                        'books>ReleaseDate'
                                    ],
                                    formatter: 'Formatter.rormatDate.bind($controller)'
                            }"/>
                        <ObjectNumber
                            number="{books>AvailableQuantity}"
                            emphasized="false"/>
                        <FlexBox>
                            <Button 
                                text="{i18n>buttonEdit}"
                                visible="{= !${books>isEditable}}"
                                press="onEditTitle"/>
                            <Button 
                                text="{i18n>buttonSave}"
                                visible="{books>isEditable}"
                                press="onSaveTitle"/>
                        </FlexBox>
                    </cells>
                </ColumnListItem>
            </items>
        </Table>
    </Page>
</mvc:View>